(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-37b460a6"],{"2f21":function(e,t,s){"use strict";var r=s("79e5");e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},"55dd":function(e,t,s){"use strict";var r=s("5ca1"),o=s("d8e8"),a=s("4bf8"),i=s("79e5"),n=[].sort,l=[1,2,3];r(r.P+r.F*(i(function(){l.sort(void 0)})||!i(function(){l.sort(null)})||!s("2f21")(n)),"Array",{sort:function(e){return void 0===e?n.call(a(this)):n.call(a(this),o(e))}})},c23a:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"add"===e.addEditType?"添加权限":"编辑权限",visible:e.addDialogVisible,fullscreen:"",center:""},on:{"update:visible":function(t){e.addDialogVisible=t}}},[s("el-form",{ref:"addForm",staticStyle:{width:"40%",margin:"auto"},attrs:{model:e.addForm,"label-width":"120px",rules:e.addFormRules,"status-icon":""}},[s("el-form-item",{attrs:{label:"所属系统",prop:"systemId"}},[s("el-select",{attrs:{clearable:""},on:{change:e.getPermissionAttrList},model:{value:e.addForm.systemId,callback:function(t){e.$set(e.addForm,"systemId",t)},expression:"addForm.systemId"}},e._l(e.availSystemAttrList,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),s("el-form-item",{attrs:{label:"类型",prop:"type"}},[s("el-select",{attrs:{clearable:""},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},[s("el-option",{attrs:{label:"菜单",value:"菜单"}}),s("el-option",{attrs:{label:"按钮",value:"按钮"}})],1)],1),s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),s("el-form-item",{attrs:{label:"描述",prop:"description"}},[s("el-input",{attrs:{type:"textarea",rows:"5",resize:"vertical"},model:{value:e.addForm.description,callback:function(t){e.$set(e.addForm,"description",t)},expression:"addForm.description"}})],1),s("el-form-item",{attrs:{label:"父菜单"}},[s("el-tree",{ref:"treeRef",attrs:{data:e.permissionAttrList,props:e.defaultProps,"node-key":"id","highlight-current":""},on:{"check-change":e.checkChange,"node-click":e.nodeClick}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"菜单"==e.addForm.type,expression:"addForm.type=='菜单'"}],attrs:{label:"路由",prop:"state"}},[s("el-input",{model:{value:e.addForm.state,callback:function(t){e.$set(e.addForm,"state",t)},expression:"addForm.state"}})],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"菜单"==e.addForm.type,expression:"addForm.type=='菜单'"}],attrs:{label:"图标",prop:"icon"}},[s("el-select",{attrs:{clearable:""},model:{value:e.addForm.icon,callback:function(t){e.$set(e.addForm,"icon",t)},expression:"addForm.icon"}},e._l(e.iconNames,function(e){return s("el-option",{key:e,attrs:{label:e,value:e}},[s("i",{class:e})])}),1)],1),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"菜单"==e.addForm.type,expression:"addForm.type=='菜单'"}],attrs:{label:"排序",prop:"sort"}},[s("el-input-number",{attrs:{min:0,max:10},model:{value:e.addForm.sort,callback:function(t){e.$set(e.addForm,"sort",t)},expression:"addForm.sort"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"default"},on:{click:e.addEditPermissionCancel}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addEditPermissionConfirm}},[e._v("确 定")])],1)],1),s("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.searchForm}},[s("el-form-item",{attrs:{label:"类型",prop:"type"}},[s("el-select",{attrs:{clearable:""},on:{change:e.searchPermissionList},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[s("el-option",{attrs:{label:"请选择",value:""}}),s("el-option",{attrs:{label:"菜单",value:"菜单"}}),s("el-option",{attrs:{label:"按钮",value:"按钮"}})],1)],1),s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{attrs:{placeholder:"名称"},on:{input:e.searchPermissionList},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),s("el-form-item",{attrs:{label:"所属系统",prop:"systemId"}},[s("el-select",{on:{change:e.searchPermissionList},model:{value:e.searchForm.systemId,callback:function(t){e.$set(e.searchForm,"systemId",t)},expression:"searchForm.systemId"}},[s("el-option",{attrs:{label:"请选择",value:""}}),e._l(e.systemAttrList,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.searchPermissionList}},[e._v("查询")]),s("el-button",{attrs:{type:"default"},on:{click:e.searchFormReset}},[e._v("重置")]),s("el-button",{attrs:{type:"success"},on:{click:function(t){return e.openPermissionDialog("add")}}},[e._v("添加")])],1)],1),s("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.list,"row-key":"id"},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{label:"ID",width:"70",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"名称",width:"180",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"描述",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.description)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"所属系统",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.systemName)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"类型",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{size:"mini",type:"菜单"===t.row.type?"info":"success"}},[e._v("\n          "+e._s(t.row.type)+"\n        ")])]}}])}),s("el-table-column",{attrs:{label:"图标",width:"60"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("i",{class:e.row.icon})]}}])}),s("el-table-column",{attrs:{label:"路由",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.state)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"排序",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.sort)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"操作时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.operateTime)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"操作人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.operator)+"\n      ")]}}])}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(s){return e.openPermissionDialog("edit",t.row)}}},[e._v("编辑")]),s("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(s){return e.deletePermission(t.row.id)}}},[e._v("删除")])]}}])})],1)],1)},o=[],a=(s("55dd"),s("7f7f"),s("cebc")),i=s("700d"),n=["el-icon-c-scale-to-original","el-icon-goods","el-icon-s-cooperation","el-icon-s-order","el-icon-s-promotion","el-icon-s-home","el-icon-s-ticket","el-icon-s-management","el-icon-s-help","el-icon-s-finance","el-icon-s-tools","el-icon-s-custom","el-icon-video-camera-solid","el-icon-bangzhu","el-icon-setting"],l=n,d={name:"Permission",data:function(){return{systemAttrList:null,availSystemAttrList:null,permissionAttrList:null,checkedId:null,defaultProps:{children:"children",label:"name"},iconNames:l,addEditType:"add",addDialogVisible:!1,addForm:{systemId:"",type:"",name:"",description:"",parentId:null,state:"",icon:"",sort:0},addFormRules:{systemId:[{required:!0,message:"请选择所属系统",trigger:"change"}],type:[{required:!0,message:"",trigger:"change"}],name:[{required:!0,message:"请输入权限名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],description:[{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}]},searchForm:{type:"",name:"",systemId:""},list:null,currentPage:1,pageSize:100,total:1}},mounted:function(){this.getSystemAttrList(),this.searchPermissionList(),this.getAvailSystemAttrList()},methods:{getSystemAttrList:function(){var e=this;this.$get(i["a"].getSystemAttrList,null).then(function(t){var s=t.data;e.systemAttrList=s})},getAvailSystemAttrList:function(){var e=this;this.$get(i["a"].getSystemAttrList,{disableFlag:0}).then(function(t){var s=t.data;e.availSystemAttrList=s})},getPermissionAttrList:function(){var e=this;this.permissionAttrList=null,this.addForm.parentId=null;var t=this.addForm.systemId;if(t)return this.$get(i["a"].getPermissionAttrList,{systemId:t}).then(function(t){var s=t.data;e.permissionAttrList=s})},searchPermissionList:function(){var e=this;this.$getLoading(i["a"].searchPermissionList,Object(a["a"])({currentPage:this.currentPage,pageSize:this.pageSize},this.searchForm)).then(function(t){var s=t.data;e.list=s.list,e.total=s.total})},searchFormReset:function(){this.$refs.searchForm.resetFields(),this.searchPermissionList()},sortChange:function(e,t,s){console.log(e,t,s)},checkChange:function(e,t,s){1==t&&this.$refs.treeRef.setCheckedNodes([e])},nodeClick:function(e,t,s){this.$refs.treeRef.setCheckedNodes([e])},openPermissionDialog:function(e,t){this.addDialogVisible=!0,this.addEditType=e,t&&(this.addForm={id:t.id,systemId:t.systemId,type:t.type,name:t.name,description:t.description,parentId:t.parentId},this.getPermissionAttrList().then(function(){this.$refs.treeRef.setCheckedKeys([t.parentId])}.bind(this)),"菜单"==this.addForm.type?(this.addForm.state=t.state,this.addForm.icon=t.icon,this.addForm.sort=t.sort):(this.addForm.state="",this.addForm.icon="",this.addForm.sort=0))},addEditPermissionCancel:function(){this.addDialogVisible=!1,this.$refs.addForm.resetFields()},addEditPermissionConfirm:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;if("菜单"==e.addForm.type){if(!e.addForm.state)return void e.$message.error("菜单类型权限需有路由！");if(!e.addForm.icon)return void e.$message.error("菜单类型需有icon！");if(!e.addForm.sort||0==e.addForm.sort)return void e.$message.error("菜单类型需有排序，不能为0！")}else e.addForm.type;var s=e.$refs.treeRef.getCheckedKeys();console.log(s)})},deletePermission:function(e){var t=this;this.$confirm("确定删除该权限？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post(i["a"].deletePermission,{roleId:e}).then(function(e){t.searchPermissionList()})})}}},c=d,m=s("2877"),u=Object(m["a"])(c,r,o,!1,null,"149f671b",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-37b460a6.dbef4ef9.js.map