(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2250de"],{e382:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"add"===e.addEditType?"添加用户":"编辑用户",visible:e.addDialogVisible,fullscreen:"",center:""},on:{"update:visible":function(t){e.addDialogVisible=t}}},[r("el-form",{ref:"addForm",staticStyle:{width:"40%",margin:"auto"},attrs:{model:e.addForm,"label-width":"120px",rules:e.addFormRules,"status-icon":""}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[r("el-input",{attrs:{type:"password","auto-complete":"off"},model:{value:e.addForm.confirmPassword,callback:function(t){e.$set(e.addForm,"confirmPassword",t)},expression:"addForm.confirmPassword"}})],1),r("el-form-item",{attrs:{label:"角色配置"}},[r("el-select",{attrs:{placeholder:"请选择系统",clearable:""},on:{change:e.getRoleAttrList},model:{value:e.addForm.systemId,callback:function(t){e.$set(e.addForm,"systemId",t)},expression:"addForm.systemId"}},e._l(e.systemAttrList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),r("el-select",{staticStyle:{"margin-left":"20px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择角色"},model:{value:e.addForm.roleIds,callback:function(t){e.$set(e.addForm,"roleIds",t)},expression:"addForm.roleIds"}},e._l(e.roleAttrList,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"default"},on:{click:e.addEditUserCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addEditUserConfirm}},[e._v("确 定")])],1)],1),r("el-form",{ref:"searchForm",attrs:{inline:!0,model:e.searchForm}},[r("el-form-item",{attrs:{label:"名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"名称"},on:{input:e.searchUserList},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}})],1),r("el-form-item",{attrs:{label:"启用状态",prop:"disableFlag"}},[r("el-select",{attrs:{placeholder:"启用状态"},on:{change:e.searchUserList},model:{value:e.searchForm.disableFlag,callback:function(t){e.$set(e.searchForm,"disableFlag",t)},expression:"searchForm.disableFlag"}},[r("el-option",{attrs:{label:"全部",value:""}}),r("el-option",{attrs:{label:"可用",value:"0"}}),r("el-option",{attrs:{label:"禁用",value:"1"}})],1)],1),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.searchUserList}},[e._v("查询")]),r("el-button",{attrs:{type:"default"},on:{click:e.searchFormReset}},[e._v("重置")]),r("el-button",{attrs:{type:"success"},on:{click:function(t){return e.openUserDialog("add")}}},[e._v("添加")])],1)],1),r("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.list}},[r("el-table-column",{attrs:{label:"ID",width:"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.id)+"\n      ")]}}])}),r("el-table-column",{attrs:{label:"名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{href:t.row.url}},[e._v(e._s(t.row.name))])]}}])}),r("el-table-column",{attrs:{label:"密码",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{href:t.row.url}},[e._v(e._s(t.row.password))])]}}])}),r("el-table-column",{attrs:{label:"启用状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.disableFlag?r("el-tag",{attrs:{size:"mini",type:"info"}},[e._v("正常")]):e._e(),1===t.row.disableFlag?r("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("禁用")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"系统 | 角色"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.roles.length>0?r("el-table",{staticStyle:{width:"100%"},attrs:{border:"","show-header":!1,data:t.row.roles}},[r("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(t.row.systemName)+"\n            ")]}}],null,!0)}),r("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.roleInfos,function(t){return r("el-tag",{key:t.id,attrs:{size:"mini",type:"info"}},[e._v(e._s(t.name)+"\n              ")])})}}],null,!0)})],1):e._e()]}}])}),r("el-table-column",{attrs:{label:"操作时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.operateTime)+"\n      ")]}}])}),r("el-table-column",{attrs:{label:"操作人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.operator)+"\n      ")]}}])}),r("el-table-column",{attrs:{label:"最近登录时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.lastLoginTime)+"\n      ")]}}])}),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(r){return e.openUserDialog("edit",t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{plain:"",type:"danger",size:"mini"},on:{click:function(r){return e.deleteUser(t.row.id)}}},[e._v("删除")]),0===t.row.disableFlag?r("el-button",{attrs:{plain:"",type:"warning",size:"mini"},on:{click:function(r){return e.disableUser(t.row.id)}}},[e._v("禁用\n        ")]):e._e(),1===t.row.disableFlag?r("el-button",{attrs:{plain:"",type:"primary",size:"mini"},on:{click:function(r){return e.enableUser(t.row.id)}}},[e._v("启用\n        ")]):e._e()]}}])})],1)],1)},s=[],l=(r("7f7f"),r("cebc")),o=r("700d"),n={name:"User",data:function(){return{systemAttrList:null,roleAttrList:null,addEditType:"add",addDialogVisible:!1,addForm:{name:"",password:"",confirmPassword:"",roleIds:[]},addFormRules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:2,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,max:8,message:"长度是 8 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请输入确认密码",trigger:"blur"},{min:8,max:8,message:"长度是 8 个字符",trigger:"blur"}]},searchForm:{name:"",disableFlag:""},list:null,currentPage:1,pageSize:100,total:1}},mounted:function(){this.getSystemAttrList(),this.searchUserList()},methods:{getSystemAttrList:function(){var e=this;this.$get(o["a"].getSystemAttrList,{disableFlag:0}).then(function(t){var r=t.data;e.systemAttrList=r})},getRoleAttrList:function(){var e=this;this.roleAttrList=null,this.addForm.roleIds=[];var t=this.addForm.systemId;t&&this.$get(o["a"].getRoleAttrList,{systemId:t}).then(function(t){var r=t.data;e.roleAttrList=r})},searchUserList:function(){var e=this;this.$getLoading(o["a"].searchUserList,Object(l["a"])({currentPage:this.currentPage,pageSize:this.pageSize},this.searchForm)).then(function(t){var r=t.data;e.list=r.list,e.total=r.total})},searchFormReset:function(){this.$refs.searchForm.resetFields(),this.searchUserList()},openUserDialog:function(e,t){this.addDialogVisible=!0,this.addEditType=e,t&&(this.addForm={id:t.id,name:t.name,password:t.password,confirmPassword:t.password,roleIds:[]})},addEditUserCancel:function(){this.addDialogVisible=!1,this.$refs.addForm.resetFields()},addEditUserConfirm:function(){var e=this;this.$refs.addForm.validate(function(t){if(!t)return!1;e.$postJsonLoading("add"===e.addEditType?o["a"].addUser:o["a"].editUser,Object(l["a"])({},e.addForm)).then(function(t){e.addEditUserCancel(),e.searchUserList()})})},deleteUser:function(e){var t=this;this.$confirm("确定删除该用户？","危险",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){t.$post(o["a"].deleteUser,{userId:e}).then(function(e){t.searchUserList()})})},disableUser:function(e){var t=this;this.$confirm("确定禁用该用户？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post(o["a"].disableUser,{userId:e}).then(function(e){t.searchUserList()})})},enableUser:function(e){var t=this;this.$post(o["a"].enableUser,{userId:e}).then(function(e){t.searchUserList()})}}},i=n,d=r("2877"),c=Object(d["a"])(i,a,s,!1,null,"04cb31a2",null);t["default"]=c.exports}}]);
//# sourceMappingURL=chunk-2d2250de.4b5f982e.js.map